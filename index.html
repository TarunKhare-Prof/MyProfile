<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tarun Khare - Portfolio</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>Tarun Khare - Sr. Software Engineer</header>

  <nav id="tabs">
    <!-- Buttons will be injected from config -->
  </nav>

  <div class="profile-wrapper">
    <img src="images/profile.jpg" class="profile-pic" id="profileImage" alt="Profile Image">
  </div>

  <div id="tabContainer"></div>

  <script>
  async function fetchJSON(path) {
    const res = await fetch(path);
    if (!res.ok) throw new Error(`Failed to load ${path}`);
    return res.json();
  }

  function showTab(tabId) {
    const contents = document.querySelectorAll('.tab-content');
    contents.forEach((el) => el.classList.remove('active'));
    const selected = document.getElementById(tabId);
    selected?.classList.add('active');
  }

  async function initPortfolio() {
    const data = await fetchJSON('data/portfolio.json');

    document.querySelector('.profile-pic').src = data.profileImage;

    const nav = document.querySelector('nav');
    const wrapper = document.body.appendChild(document.createElement('div'));
    wrapper.id = 'tabWrapper';

    for (const tab of data.tabs) {
      const btn = document.createElement('button');
      btn.textContent = tab.label;
      btn.onclick = () => showTab(tab.id);
      nav.appendChild(btn);

      const section = document.createElement('div');
      section.className = 'tab-content';
      section.id = tab.id;

      section.innerHTML = `<h2>${tab.title}</h2>`;

      if (tab.id === 'personal') {
        section.innerHTML += tab.projects.map(p => `
          <div class="project-card">
            <h3>${p.title}</h3>
            ${
              p.type === 'video'
                ? `<video controls><source src="${p.src}" type="video/mp4"></video>`
                : `<img src="${p.src}" alt="${p.title}">`
            }
            <p>${p.description}</p>
          </div>
        `).join('');
      } else {
        section.innerHTML += tab.content.map(item => `<p>${item}</p>`).join('');
      }

      wrapper.appendChild(section);
    }

    showTab(data.tabs[0].id);
  }

  initPortfolio();
</script>

</body>
</html>
