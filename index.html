<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tarun Khare – Portfolio</title>
  <link rel="stylesheet" href="style.css?v=1.0.4" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  
	<style>
	  .download-btn{
		position:fixed;top:14px;right:14px;z-index:2000;
		background:#2563eb;color:#fff;border:none;padding:10px 14px;
		border-radius:8px;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,.2);font-weight:600;
	  }
	  .download-btn:hover{background:#1e40af}

	  /* Important: keep rendered but invisible (no opacity:0) */
	  #resumeRoot{
		position:fixed; left:0; top:0; width:794px;   /* A4-ish at 96dpi */
		background:#fff; color:#111;
		visibility:hidden;           /* <-- not opacity */
		pointer-events:none;
		z-index:2147483000;          /* above page when shown for capture */
	  }
	</style>

</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y230QVB9W6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Y230QVB9W6');
</script>

<body>

  

  <header>
    <svg class="wave" viewBox="0 0 1440 90" preserveAspectRatio="none">
      <path d="M0,50 C400,140 1040,-40 1440,50 L1440,90 L0,90 Z"></path>
    </svg>
    <div class="header-content">
      <img src="images/profile.jpg" alt="Tarun Khare" class="profile-pic" />
      <div class="text-content">
        <h1>Tarun Khare</h1>
        <h2>Sr. Software Engineer</h2>
        <h3>Alstom Transport (Bangalore)</h3>
        <h3>Open To Work , LWD : 4th Oct 2025 </h3>
		<h4>In coding, nothing is impossible. There’s always a smarter, faster way to optimize, and you’re not bad at it, you just need to dig deeper and research.</h4>
		<h4>By the time an idea hits you, someone’s already building it. Start today, or watch your dream become someone else’s success tomorrow.</h4>
      </div>
    </div>
  </header>

  <nav id="tabs"></nav>
  <main id="tabWrapper"></main>

  <div id="lightbox" class="hidden">
    <span class="close">&times;</span>
    <div class="lightbox-content"></div>
  </div>

  

  <script>
    const fetchJSON = async (p) => (await fetch(p)).json();

    // --- helper: show active tab ---
    function showTab(id) {
      document.querySelectorAll('.tab-content')
              .forEach(el => el.classList.toggle('active', el.id === id));
    }

    // --- helper: lightbox ---
    function openLightbox(html) {
      const lb = document.getElementById('lightbox');
      const content = lb.querySelector('.lightbox-content');
      content.innerHTML = html;

      const video = content.querySelector('video');
      if (video) {
        video.setAttribute('autoplay', true);
        video.setAttribute('controls', true);
        video.setAttribute('playsinline', true);
        video.play().catch(err => console.log("Autoplay blocked:", err));
      }

      void content.offsetHeight;
      lb.style.display = 'flex';
      lb.classList.remove('hidden');
    }

    function closeLightbox() {
      const lb = document.getElementById('lightbox');
      const content = lb.querySelector('.lightbox-content');
      const video = content.querySelector('video');
      if (video) {
        video.pause();
        video.currentTime = 0;
      }
      content.innerHTML = '';
      lb.style.display = 'none';
      lb.classList.add('hidden');
    }

    // ============ NEW: renderer for Professional Projects ============
    function renderProfessionalProjects(container, contentArray) {
      if (!Array.isArray(contentArray)) {
        container.innerHTML += `<p class="note">No projects to display.</p>`;
        return;
      }

      if (!document.getElementById('proj-inline-style')) {
        const s = document.createElement('style');
        s.id = 'proj-inline-style';
        s.textContent = `
          .project-card{background:#fff;margin:16px 0;padding:20px;border-left:5px solid #2980b9;box-shadow:0 2px 6px rgba(0,0,0,.08);border-radius:10px}
          .project-card strong{display:block;font-size:18px;color:#2c3e50;margin-bottom:8px}
          .project-card p{margin:6px 0;line-height:1.5}
          .languages{margin-top:10px;font-size:14px;display:flex;flex-wrap:wrap;gap:6px}
          .language-tag{display:inline-block;background:#e8f0fe;color:#1a73e8;padding:4px 8px;border-radius:14px;line-height:1;white-space:nowrap}
          .note{color:#666;font-size:14px;margin-top:8px}
        `;
        document.head.appendChild(s);
      }

      const frag = document.createDocumentFragment();

      contentArray.forEach(entry => {
        const card = document.createElement('div');
        card.className = 'project-card';

        if (entry && typeof entry === 'object' && entry.description) {
          const langs = Array.isArray(entry.languages) ? entry.languages : [];
          card.innerHTML = `
            ${entry.description}
            ${langs.length ? `
              <div class="languages">
                ${langs.map(l => `<span class="language-tag">${l}</span>`).join('')}
              </div>` : `<div class="note">Languages not specified.</div>`}
          `;
        } else if (typeof entry === 'string') {
          if (entry.includes('<strong>')) {
            const splitIndex = entry.indexOf('</strong>') + 9;
            const title = entry.slice(0, splitIndex);
            const desc = entry.slice(splitIndex).trim();
            card.innerHTML = `${title}<p>${desc}</p>`;
          } else {
            card.innerHTML = `<p>${entry}</p>`;
          }
        } else {
          card.innerHTML = `<p>${String(entry)}</p>`;
        }

        frag.appendChild(card);
      });

      container.appendChild(frag);
    }
    // ================================================================

    (async () => {
      const data = await fetchJSON('data/portfolio.json');
      const skillsData = await fetchJSON('data/skills.json');
      const nav = document.getElementById('tabs');
      const wrap = document.getElementById('tabWrapper');

      for (let i = 0; i < data.tabs.length; i++) {
        const tab = data.tabs[i];

        const btn = document.createElement('button');
        btn.innerHTML = `<i class="fa-regular fa-circle"></i> ${tab.label}`;
        btn.onclick = () => showTab(tab.id);
        nav.appendChild(btn);

        const sec = document.createElement('section');
        sec.className = 'tab-content' + (tab.id === 'skills' ? ' full-width' : '');
        sec.id = tab.id;

        if (tab.id !== 'skills') {
          sec.innerHTML = `<h2>${tab.title}</h2>`;
        }

        if (tab.id === 'personal') {
          const personalData = await fetchJSON('data/personal_projects.json');
          const grid = document.createElement('div');
          grid.className = 'projects-flex-list';

          grid.innerHTML = personalData.map((p, index) => {
            const mediaList = Array.isArray(p.src) ? p.src.map(m => m.url) : [];
            const desc = p.description || {};
            const mediaNav = mediaList.length > 1 ? `
              <button class="media-nav prev" onclick="showPrev(${index})">&#8592;</button>
              <button class="media-nav next" onclick="showNext(${index})">&#8594;</button>` : '';

            const mediaContent = mediaList.map((src, i) => {
              const ext = src.split('.').pop().toLowerCase();
              const mimeType =
                ext === 'mp4' ? 'video/mp4' :
                ext === 'webm' ? 'video/webm' :
                ext === 'ogg' ? 'video/ogg' : 'video/mp4';

              return (ext === 'mp4' || ext === 'webm' || ext === 'ogg')
                ? `<video preload="metadata" muted class="media-item ${i === 0 ? 'active' : ''}" onclick="openLightbox(this.outerHTML)">
                     <source src="${src}" type="${mimeType}">
                   </video>`
                : `<img src="${src}" class="media-item ${i === 0 ? 'active' : ''}" alt="${p.title}" onclick="openLightbox(this.outerHTML)">`;
            }).join('');

            return `
              <div class="project-row" id="project-${index}">
                <div class="media-column">
                  <div class="media-wrapper">
                    ${mediaContent}
                    ${mediaNav}
                  </div>
                </div>
                <div class="desc-column">
                  <h3>${p.title}</h3>
                  <p><strong>About:</strong> ${desc.about || ""}</p>
                  <p><strong>Software:</strong> ${desc.coding || ""}</p>
                  <p><strong>Hardware:</strong> ${desc.hardware || ""}</p>
                  <p><strong>Additional Info:</strong> ${desc.additional || ""}</p>
                </div>
              </div>
            `;
          }).join('');

          sec.appendChild(grid);

        } else if (tab.id === 'skills') {
          const table = document.createElement('table');
          table.className = 'skills-table';

          const grouped = skillsData.reduce((acc, skill) => {
            (acc[skill.category] = acc[skill.category] || []).push(skill);
            return acc;
          }, {});

          const levelOrder = { "Advanced": 5, "Working Level": 4, "Intermediate": 3, "Basic": 2, "Learning": 1 };

          let rows = '';
          Object.entries(grouped).forEach(([category, skills]) => {
            rows += `<tr class="category-row"><td colspan="5">${category}</td></tr>`;
            skills.sort((a, b) => (levelOrder[b.level] || 0) - (levelOrder[a.level] || 0)).forEach(skill => {
              const highlight = (skill.status || '').toLowerCase() === 'using' ? ' style="background-color:#eaffea"' : '';
              rows += `
                <tr${highlight}>
                  <td></td>
                  <td>${skill.name}</td>
                  <td>${skill.level}</td>
                  <td>${skill.status || ''}</td>
                </tr>`;
            });
          });

          table.innerHTML = `
            <thead>
              <tr>
                <th>Category</th>
                <th>Name</th>
                <th>Level</th>
                <th>Status / Last Used</th>
              </tr>
            </thead>
            <tbody>${rows}</tbody>
          `;

          const skillsWrapper = document.createElement('div');
          skillsWrapper.className = 'skills-wrapper';
          skillsWrapper.appendChild(table);
          sec.appendChild(skillsWrapper);

          const guideCard = document.createElement('div');
          guideCard.className = 'level-guide-card';
          guideCard.innerHTML = `
            <h3>Level Guide</h3>
            <table class="level-guide">
              <thead>
                <tr><th>Level</th><th>Label</th></tr>
              </thead>
              <tbody>
                <tr><td>5</td><td>Advanced</td></tr>
                <tr><td>4</td><td>Working Level</td></tr>
                <tr><td>3</td><td>Intermediate</td></tr>
                <tr><td>2</td><td>Basic</td></tr>
                <tr><td>1</td><td>Learning</td></tr>
              </tbody>
            </table>
          `;
          sec.appendChild(guideCard);

        } else if (tab.id === 'projects') {
          const holder = document.createElement('div');
          holder.id = 'projects-holder';
          sec.appendChild(holder);
          renderProfessionalProjects(holder, tab.content);

        } else if (tab.skillsGrouped) {
          Object.entries(tab.skillsGrouped).forEach(([category, skills]) => {
            const grid = document.createElement('div');
            grid.className = 'skills-grid';
            grid.innerHTML = `<h3>${category}</h3>` +
              skills.map(sk => `<div class="skill">${sk.name}</div>`).join('');
            sec.appendChild(grid);
          });

        } else if (tab.skills) {
          sec.innerHTML += `<div class="skills-bars">
            ${tab.skills.map(sk => `
              <div class="skill-bar">
                <span>${sk.name}</span>
                <div class="bar"><div class="fill" style="width:${sk.level}%"></div></div>
              </div>`).join('')}
          </div>`;

        } else if (tab.content) {
          sec.innerHTML += tab.content.map(t => `<p>${t}</p>`).join('');
        }

        wrap.appendChild(sec);
        if (i === 0) sec.classList.add('active');
      }

      document.getElementById('lightbox').addEventListener('click', (e) => {
        if (e.target.id === 'lightbox' || e.target.classList.contains('close')) {
          closeLightbox();
        }
      });

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          closeLightbox();
        }
      });
    })();

    function showPrev(index) {
      const items = document.querySelectorAll(`#project-${index} .media-item`);
      const current = [...items].findIndex(i => i.classList.contains('active'));
      if (current > 0) {
        items[current].classList.remove('active');
        items[current - 1].classList.add('active');
      }
    }
    function showNext(index) {
      const items = document.querySelectorAll(`#project-${index} .media-item`);
      const current = [...items].findIndex(i => i.classList.contains('active'));
      if (current < items.length - 1) {
        items[current].classList.remove('active');
        items[current + 1].classList.add('active');
      }
    }
  </script>

  <footer>
    <div class="footer-inner">
      <p>Made with 💻 by Tarun Khare &copy; <span id="year"></span></p>
      <p>Last Updated: <span id="lastModified"></span></p>
      <div class="social">
        <p>Connect On :</p>
        <a href="https://www.linkedin.com/in/tarun-khare-98ab5085/" aria-label="LinkedIn">
          <i class="fa-brands fa-linkedin"></i>
        </a>
      </div>
    </div>
  </footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
    document.getElementById('lastModified').textContent = new Date(document.lastModified).toLocaleString();
  </script>

  <!-- Hidden resume root -->
	<div id="resumeRoot" style="
	  position: fixed; left: 0; top: 0; width: 794px;
	  background:#fff; color:#111; opacity:0; pointer-events:none;">
	</div>

	<!-- Only these two libs -->
	<script defer src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
	<script defer src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>

	<!-- Exporter (no html2pdf usage) -->
	<script defer src="js/resume-export.js?v=2"></script>

</body>
</html>
